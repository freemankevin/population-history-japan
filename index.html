<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>日本历史人口变化模型</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #ff6b9d 0%, #c44569 50%, #3742fa 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: white;
            padding: 40px 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .header::before {
            content: '🌸';
            position: absolute;
            font-size: 4rem;
            opacity: 0.1;
            top: 20px;
            right: 30px;
            animation: float 6s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }
        
        .header h1 {
            font-size: 3rem;
            margin-bottom: 15px;
            font-weight: 800;
            position: relative;
            z-index: 1;
        }
        
        .header p {
            font-size: 1.2rem;
            opacity: 0.95;
            position: relative;
            z-index: 1;
        }
        
        .controls {
            padding: 25px 30px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            align-items: center;
            justify-content: center;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 30px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.4s ease;
            background: linear-gradient(135deg, #ffffff 0%, #f1f3f4 100%);
            color: #333;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            font-size: 0.9rem;
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        
        .btn.active {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: white;
            transform: translateY(-2px);
        }
        
        .chart-container {
            padding: 40px;
            height: 600px;
            position: relative;
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
        }
        
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 25px;
            padding: 40px;
            background: #f8f9fa;
        }
        
        .stats-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.08);
            border-left: 5px solid #e74c3c;
            transition: transform 0.3s ease;
        }
        
        .stats-card:hover {
            transform: translateY(-5px);
        }
        
        .stats-card h3 {
            color: #e74c3c;
            margin-bottom: 20px;
            font-size: 1.3rem;
            font-weight: 700;
        }
        
        .period-item {
            margin-bottom: 15px;
            padding: 12px 0;
            border-bottom: 1px solid #e9ecef;
            transition: background 0.2s ease;
        }
        
        .period-item:hover {
            background: #f8f9fa;
            border-radius: 8px;
            padding-left: 8px;
        }
        
        .period-item:last-child {
            border-bottom: none;
        }
        
        .period-name {
            font-weight: 600;
            color: #333;
            font-size: 1rem;
        }
        
        .period-years {
            color: #666;
            font-size: 0.9rem;
            margin-top: 2px;
        }
        
        .period-population {
            color: #e74c3c;
            font-weight: 600;
            margin-top: 5px;
        }
        
        .crisis-item {
            background: #fef2f2;
            border-left: 4px solid #ef4444;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
        }
        
        .unique-item {
            background: #f0f9ff;
            border-left: 4px solid #3b82f6;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
        }
        
        .archaeology-item {
            background: #f6f3ff;
            border-left: 4px solid #8b5cf6;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
        }
        
        .footer {
            background: linear-gradient(135deg, #2d3748 0%, #1a202c 100%);
            color: white;
            padding: 30px;
            line-height: 1.8;
        }
        
        .footer h4 {
            color: #ff6b9d;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }
        
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2.2rem;
            }
            
            .controls {
                flex-direction: column;
            }
            
            .chart-container {
                height: 450px;
                padding: 25px;
            }
            
            .stats-container {
                padding: 25px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>日本历史人口变化模型</h1>
            <p>从绳文时代至今的日本列岛人口演变轨迹</p>
        </div>
        
        <div class="controls">
            <button class="btn active" onclick="setPeriod('all')">完整历史</button>
            <button class="btn" onclick="setPeriod('ancient')">古代（前10000-1185年）</button>
            <button class="btn" onclick="setPeriod('medieval')">中世纪（1185-1603年）</button>
            <button class="btn" onclick="setPeriod('edo')">江户时代（1603-1868年）</button>
            <button class="btn" onclick="setPeriod('modern')">近现代（1868年至今）</button>
            <label style="display: flex; align-items: center; margin-left: 20px; color: #666;">
                <input type="checkbox" id="showEvents" checked onchange="toggleEvents()" style="margin-right: 8px;">
                显示重大历史事件
            </label>
        </div>
        
        <div class="chart-container">
            <canvas id="populationChart"></canvas>
        </div>
        
        <div class="stats-container">
            <div class="stats-card">
                <h3>主要历史时期人口</h3>
                <div id="periodStats"></div>
            </div>
            
            <div class="stats-card">
                <h3>日本人口独特现象</h3>
                <div id="uniqueFeatures"></div>
            </div>
            
            <div class="stats-card" id="eventsCard">
                <h3>重大历史事件影响</h3>
                <div id="historicalEvents"></div>
            </div>
            
            <div class="stats-card">
                <h3>考古学与史学证据</h3>
                <div id="evidenceData"></div>
            </div>
        </div>
        
        <div class="footer">
            <h4>数据来源与说明</h4>
            <p><strong>考古学数据：</strong>绳文、弥生时代人口主要依据遗址密度、住居数量、贝塚规模等考古证据推算</p>
            <p><strong>古代文献：</strong>《日本书纪》《续日本纪》等史书记载，以及平安时代的户籍制度资料</p>
            <p><strong>江户时代：</strong>幕府的宗门人别帳（户籍制度）提供相对准确的人口统计</p>
            <p><strong>近现代：</strong>明治政府建立的戸籍制度和国势调查（人口普查）数据</p>
            <br>
            <p><em>注：日本作为岛国，人口变化相对独立，受大陆战乱影响较小，但自然灾害（地震、火山、海啸）对人口影响显著</em></p>
        </div>
    </div>

    <script>
        // 日本历史人口数据（单位：万人）
        const japanPopulationData = [
            { year: -10000, population: 2, era: '旧石器时代晚期', period: '先史时代' },
            { year: -8000, population: 5, era: '绳文时代早期', period: '绳文时代' },
            { year: -5000, population: 15, era: '绳文时代中期', period: '绳文时代' },
            { year: -2000, population: 20, era: '绳文时代晚期', period: '绳文时代' },
            { year: -500, population: 60, era: '弥生时代', period: '弥生时代' },
            { year: 300, population: 300, era: '古坟时代', period: '古代' },
            { year: 600, population: 450, era: '飞鸟时代', period: '古代' },
            { year: 700, population: 500, era: '奈良时代', period: '古代' },
            { year: 800, population: 550, era: '平安时代初期', period: '平安时代' },
            { year: 1000, population: 650, era: '平安时代中期', period: '平安时代' },
            { year: 1150, population: 680, era: '平安时代末期', period: '平安时代' },
            { year: 1200, population: 700, era: '镰仓时代初期', period: '镰仓时代' },
            { year: 1300, population: 800, era: '镰仓时代末期', period: '镰仓时代' },
            { year: 1400, population: 900, era: '室町时代', period: '室町时代' },
            { year: 1500, population: 1000, era: '战国时代', period: '战国时代' },
            { year: 1600, population: 1200, era: '安土桃山时代', period: '安土桃山' },
            { year: 1650, population: 1800, era: '江户时代初期', period: '江户时代' },
            { year: 1700, population: 2800, era: '江户时代元禄', period: '江户时代' },
            { year: 1750, population: 3100, era: '江户时代中期', period: '江户时代' },
            { year: 1800, population: 3200, era: '江户时代后期', period: '江户时代' },
            { year: 1850, population: 3200, era: '江户时代末期', period: '江户时代' },
            { year: 1870, population: 3300, era: '明治维新初期', period: '明治时代' },
            { year: 1900, population: 4400, era: '明治后期', period: '明治时代' },
            { year: 1920, population: 5600, era: '大正时代', period: '大正时代' },
            { year: 1940, population: 7200, era: '昭和战争期', period: '昭和时代' },
            { year: 1945, population: 7200, era: '战败时', period: '昭和时代' },
            { year: 1950, population: 8320, era: '战后复兴', period: '昭和时代' },
            { year: 1960, population: 9430, era: '高度经济成长', period: '昭和时代' },
            { year: 1970, population: 10370, era: '经济起飞', period: '昭和时代' },
            { year: 1980, population: 11710, era: '泡沫经济前', period: '昭和时代' },
            { year: 1990, population: 12360, era: '泡沫经济顶峰', period: '平成时代' },
            { year: 2000, population: 12690, era: '失落的十年', period: '平成时代' },
            { year: 2010, population: 12810, era: '人口峰值', period: '平成时代' },
            { year: 2020, population: 12540, era: '少子高龄化', period: '令和时代' },
            { year: 2024, population: 12400, era: '人口减少社会', period: '令和时代' }
        ];

        // 重大历史事件对人口的影响
        const historicalEvents = [
            { year: -500, event: '弥生文化传入', impact: '稻作农业开始，人口增长加速' },
            { year: 600, event: '佛教传入', impact: '文化发展促进人口稳定增长' },
            { year: 1185, event: '镰仓幕府建立', impact: '武士政治确立' },
            { year: 1467, event: '应仁之乱', impact: '战国时代开始，人口增长放缓' },
            { year: 1603, event: '江户幕府建立', impact: '锁国政策，人口增长停滞' },
            { year: 1782, event: '天明大饥荒', impact: '人口大减，江户时代最严重饥荒' },
            { year: 1853, event: '黑船来航', impact: '开国压力增大' },
            { year: 1868, event: '明治维新', impact: '现代化开始，人口快速增长' },
            { year: 1923, event: '关东大地震', impact: '东京地区人口大量死亡' },
            { year: 1945, event: '二战战败', impact: '战争死亡与海外移民回归' },
            { year: 1970, event: '大阪万博', impact: '经济黄金期，婴儿潮结束' },
            { year: 2011, event: '东日本大地震', impact: '人口减少趋势加速' }
        ];

        // 考古学与史学证据
        const evidenceData = [
            { period: '绳文时代早期', evidence: '夏岛贝塚', population: '5万人', method: '遗址密度分析' },
            { period: '绳文时代中期', evidence: '三内丸山遗址', population: '15万人', method: '大型聚落规模推算' },
            { period: '弥生时代', evidence: '吉野里遗址', population: '60万人', method: '稻作村落分布' },
            { period: '古坟时代', evidence: '仁德天皇陵', population: '300万人', method: '古坟规模与人力需求' },
            { year: 725, evidence: '《日本书纪》', population: '500万人', method: '户籍制度记录' },
            { year: 1600, evidence: '太閤検地', population: '1200万人', method: '豊臣秀吉全国土地调查' },
            { year: 1721, evidence: '享保6年人口调査', population: '2612万人', method: '幕府正式人口调查' }
        ];

        let chart;
        let currentPeriod = 'all';
        let showEvents = true;

        function initChart() {
            const ctx = document.getElementById('populationChart').getContext('2d');
            
            chart = new Chart(ctx, {
                type: 'line',
                data: {
                    datasets: [{
                        label: '日本人口（万人）',
                        data: getFilteredData(),
                        borderColor: '#e74c3c',
                        backgroundColor: 'rgba(231, 76, 60, 0.1)',
                        borderWidth: 4,
                        pointBackgroundColor: '#e74c3c',
                        pointBorderColor: '#ffffff',
                        pointBorderWidth: 3,
                        pointRadius: 6,
                        pointHoverRadius: 10,
                        fill: true,
                        tension: 0.3
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: '日本历史人口变化（万人）',
                            font: {
                                size: 20,
                                weight: 'bold'
                            },
                            color: '#333'
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0,0,0,0.8)',
                            titleColor: '#fff',
                            bodyColor: '#fff',
                            borderColor: '#e74c3c',
                            borderWidth: 2,
                            callbacks: {
                                title: function(context) {
                                    const year = context[0].parsed.x;
                                    return year < 0 ? `公元前${Math.abs(year)}年` : `公元${year}年`;
                                },
                                label: function(context) {
                                    const dataPoint = japanPopulationData.find(d => d.year === context.parsed.x);
                                    return [
                                        `人口: ${context.parsed.y.toLocaleString()} 万人`,
                                        `时代: ${dataPoint?.period || ''}`,
                                        `时期: ${dataPoint?.era || ''}`
                                    ];
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            type: 'linear',
                            title: {
                                display: true,
                                text: '年份',
                                font: { size: 14, weight: 'bold' }
                            },
                            ticks: {
                                callback: function(value) {
                                    return value < 0 ? `前${Math.abs(value)}` : `${value}`;
                                },
                                font: { size: 12 }
                            },
                            grid: {
                                color: 'rgba(0,0,0,0.1)'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: '人口（万人）',
                                font: { size: 14, weight: 'bold' }
                            },
                            ticks: {
                                callback: function(value) {
                                    return value.toLocaleString();
                                },
                                font: { size: 12 }
                            },
                            grid: {
                                color: 'rgba(0,0,0,0.1)'
                            }
                        }
                    },
                    interaction: {
                        intersect: false,
                        mode: 'index'
                    }
                }
            });

            updatePeriodStats();
            updateUniqueFeatures();
            updateHistoricalEvents();
            updateEvidenceData();
        }

        function getFilteredData() {
            let filtered;
            switch(currentPeriod) {
                case 'ancient':
                    filtered = japanPopulationData.filter(d => d.year <= 1185);
                    break;
                case 'medieval':
                    filtered = japanPopulationData.filter(d => d.year >= 1185 && d.year <= 1603);
                    break;
                case 'edo':
                    filtered = japanPopulationData.filter(d => d.year >= 1603 && d.year <= 1868);
                    break;
                case 'modern':
                    filtered = japanPopulationData.filter(d => d.year >= 1868);
                    break;
                default:
                    filtered = japanPopulationData;
            }
            
            return filtered.map(d => ({
                x: d.year,
                y: d.population
            }));
        }

        function setPeriod(period) {
            currentPeriod = period;
            
            // 更新按钮状态
            document.querySelectorAll('.btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // 更新图表数据
            chart.data.datasets[0].data = getFilteredData();
            chart.update();
        }

        function toggleEvents() {
            showEvents = document.getElementById('showEvents').checked;
            document.getElementById('eventsCard').style.display = showEvents ? 'block' : 'none';
        }

        function updatePeriodStats() {
            const majorPeriods = [
                { name: '绳文时代中期', years: '公元前5000年', population: '15万人', note: '狩猎采集社会的人口峰值' },
                { name: '弥生时代', years: '公元前500年', population: '60万人', note: '稻作农业传入，人口大增' },
                { name: '奈良时代', years: '公元700年', population: '500万人', note: '律令制度确立' },
                { name: '平安时代盛期', years: '公元1000年', population: '650万人', note: '贵族文化繁荣' },
                { name: '江户时代初期', years: '公元1650年', population: '1800万人', note: '德川和平时代开始' },
                { name: '江户时代峰值', years: '公元1750年', population: '3100万人', note: '人口增长停滞开始' },
                { name: '明治维新', years: '公元1870年', population: '3300万人', note: '现代化起点' },
                { name: '战前峰值', years: '公元1940年', population: '7200万人', note: '军国主义时期' },
                { name: '现代峰值', years: '公元2010年', population: '12810万人', note: '人口转折点' },
                { name: '当前', years: '公元2024年', population: '12400万人', note: '人口减少社会' }
            ];

            const container = document.getElementById('periodStats');
            container.innerHTML = majorPeriods.map(period => `
                <div class="period-item">
                    <div class="period-name">${period.name}</div>
                    <div class="period-years">${period.years}</div>
                    <div class="period-population">${period.population} - ${period.note}</div>
                </div>
            `).join('');
        }

        function updateUniqueFeatures() {
            const uniqueFeatures = [
                { 
                    feature: '江户时代人口停滞', 
                    description: '1700-1850年人口几乎零增长，世界罕见现象',
                    reason: '锁国政策、社会稳定但资源有限'
                },
                { 
                    feature: '明治维新人口爆发', 
                    description: '1870-1940年70年间人口翻倍',
                    reason: '现代医学引入、工业化发展'
                },
                { 
                    feature: '世界最快老龄化', 
                    description: '1990年后少子高龄化急速发展',
                    reason: '经济发达、生育观念改变'
                },
                { 
                    feature: '人口密度极高', 
                    description: '在有限国土上维持1.2亿人口',
                    reason: '岛国地理、精耕细作农业'
                },
                { 
                    feature: '自然灾害抗性', 
                    description: '频繁地震火山但人口恢复能力强',
                    reason: '防灾意识、社会组织完善'
                }
            ];

            const container = document.getElementById('uniqueFeatures');
            container.innerHTML = uniqueFeatures.map(feature => `
                <div class="unique-item">
                    <div style="font-weight: 600; color: #1e40af;">${feature.feature}</div>
                    <div style="margin: 8px 0; color: #666;">${feature.description}</div>
                    <div style="font-size: 0.9rem; color: #3b82f6; font-weight: 500;">原因：${feature.reason}</div>
                </div>
            `).join('');
        }

        function updateHistoricalEvents() {
            const container = document.getElementById('historicalEvents');
            container.innerHTML = historicalEvents.map(event => `
                <div class="crisis-item">
                    <div style="font-weight: 600; color: #dc2626;">
                        ${event.year < 0 ? `公元前${Math.abs(event.year)}年` : `公元${event.year}年`} - ${event.event}
                    </div>
                    <div style="margin-top: 8px; color: #666; font-size: 0.9rem;">${event.impact}</div>
                </div>
            `).join('');
        }

        function updateEvidenceData() {
            const container = document.getElementById('evidenceData');
            container.innerHTML = evidenceData.map(evidence => `
                <div class="archaeology-item">
                    <div style="font-weight: 600; color: #7c3aed;">${evidence.period}</div>
                    <div style="margin: 5px 0; color: #666;">
                        ${evidence.evidence ? `证据：${evidence.evidence}` : `时间：${evidence.year}年`}
                    </div>
                    <div style="color: #8b5cf6; font-weight: 600;">
                        推算人口：${evidence.population}
                    </div>
                    <div style="font-size: 0.8rem; color: #a855f7; margin-top: 3px;">
                        方法：${evidence.method}
                    </div>
                </div>
            `).join('');
        }

        // 页面加载完成后初始化
        window.addEventListener('load', function() {
            initChart();
        });
    </script>
</body>
</html>
